<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Viola in Finna • finna</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Viola in Finna">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">finna</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Fennica.html">Fennica in Finna</a></li>
    <li><a class="dropdown-item" href="../articles/finna_collections.html">Overview of Finna Collection</a></li>
    <li><a class="dropdown-item" href="../articles/refinemetadata.html">Refine finna metadata</a></li>
    <li><a class="dropdown-item" href="../articles/vignette.html">Introduction to finna</a></li>
    <li><a class="dropdown-item" href="../articles/viola_collections.html">Viola in Finna</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav"></ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Viola in Finna</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rOpenGov/finna/blob/main/vignettes/articles/viola_collections.Rmd" class="external-link"><code>vignettes/articles/viola_collections.Rmd</code></a></small>
      <div class="d-none name"><code>viola_collections.Rmd</code></div>
    </div>

    
    
<p><a href="https://kansalliskirjasto.finna.fi/Content/viola" class="external-link">Viola</a>
is the Finnish national discography and the national bibliography of
sheet music, maintained by the National Library of Finland. It contains
information on Finnish music recordings and sheet music, as well as
music archives included in the National Library’s collections.</p>
<p>This R Markdown document provides a comprehensive guide to querying
and analyzing Viola collection data using the Finna API and the
<code>fetch_viola_records</code> function.</p>
<div class="section level2">
<h2 id="viola-collection-in-finna">Viola Collection in Finna<a class="anchor" aria-label="anchor" href="#viola-collection-in-finna"></a>
</h2>
<p>The <code>fetch_viola_records</code> function allows batch processing
of data from the Viola collection in Finna, across multiple year ranges,
and handles records without date information.</p>
<div class="section level3">
<h3 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h3>
<div class="section level4">
<h4 id="fetch-data-across-year-ranges">Fetch Data Across Year Ranges<a class="anchor" aria-label="anchor" href="#fetch-data-across-year-ranges"></a>
</h4>
<p>The following example fetches data from the Viola collection for the
year ranges: 0–1699, 1700–1799, and 1800–1899.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ropengov.github.io/finna/" class="external-link">finna</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch records</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetch_viola_records.html">fetch_viola_records</a></span><span class="op">(</span></span>
<span>  base_query <span class="op">=</span> <span class="st">"*"</span>,</span>
<span>  base_filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'collection:"VIO"'</span><span class="op">)</span>, <span class="co"># Filters for the Viola collection</span></span>
<span>  year_ranges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1699</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1700</span>,<span class="fl">1799</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1800</span>,<span class="fl">1899</span><span class="op">)</span><span class="op">)</span>,           <span class="co"># Year ranges to query</span></span>
<span>  include_na <span class="op">=</span> <span class="cn">TRUE</span>,                   <span class="co"># Include records with missing dates</span></span>
<span>  limit_per_query <span class="op">=</span> <span class="fl">100000</span>,              <span class="co"># Maximum records per query</span></span>
<span>  total_limit <span class="op">=</span> <span class="cn">Inf</span>,                 <span class="co"># Overall record limit</span></span>
<span>  delay_after_query <span class="op">=</span> <span class="fl">3</span>                <span class="co"># Delay between API calls</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># View the number of records fetched</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3478</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">##   id    Title Author Year  Language Formats Subjects Library Series last_indexed</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> fikk… Demo  <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    zxx      Äänite… <span style="color: #BB0000;">NA</span>       Kansal… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> fikk… Een … Palm,… 1678  swe      Nuotti  1678; t… Kansal… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> fikk… [Ant… <span style="color: #BB0000;">NA</span>     1608  lat      Nuotti  arkisto… Kansal… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> fikk… [Zac… <span style="color: #BB0000;">NA</span>     1676  swe      Nuotti  Collian… Kansal… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> fikk… [Gra… <span style="color: #BB0000;">NA</span>     1616  fin      Nuotti  arkisto… Kansal… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> fikk… [Kor… <span style="color: #BB0000;">NA</span>     1679  lat      Nuotti  arkisto… Kansal… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="fetch-records-without-dates">Fetch Records Without Dates<a class="anchor" aria-label="anchor" href="#fetch-records-without-dates"></a>
</h4>
<p>You can also fetch records missing the <code>main_date_str</code>
field:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fetch undated records</span></span>
<span><span class="va">undated_records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_finna.html">search_finna</a></span><span class="op">(</span></span>
<span>  query <span class="op">=</span> <span class="st">"*"</span>,</span>
<span>  filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'collection:"VIO"'</span>, <span class="st">'-main_date_str:*'</span><span class="op">)</span>,</span>
<span>  limit <span class="op">=</span> <span class="cn">Inf</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View undated records</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">undated_records</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2,685 × 10</span></span></span>
<span><span class="co">##    id             Title    Author Year  Language Formats Subjects Library Series</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> fikka.5207343  [Gradua… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    fin      Nuotti  arkisto… Kansal… <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> jykdok.1827911 Sotiemm… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    fin      Äänite… <span style="color: #BB0000;">NA</span>       Jyväsk… <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> fikka.4941590  Demo     <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    zxx      Äänite… <span style="color: #BB0000;">NA</span>       Kansal… <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> fikka.4941603  Boogie … <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    zxx      Äänite… <span style="color: #BB0000;">NA</span>       Kansal… <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> fikka.4941825  Close-up <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    zxx      Äänite… <span style="color: #BB0000;">NA</span>       Kansal… <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> fikka.4997308  [Demo]   <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    zxx      Äänite… <span style="color: #BB0000;">NA</span>       Kansal… <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> fikka.4997735  [Demo]   <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    zxx      Äänite… <span style="color: #BB0000;">NA</span>       Kansal… <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> fikka.5206900  Oulu Ho… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    mul      Äänite… amerika… Kansal… <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> fikka.4997560  [Demo]   <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    eng      Äänite… <span style="color: #BB0000;">NA</span>       Kansal… <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> fikka.4994228  [Demo]   <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    zxx      Äänite… <span style="color: #BB0000;">NA</span>       Kansal… <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 2,675 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: last_indexed &lt;chr&gt;</span></span></span></code></pre>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="data-visualization">Data Visualization<a class="anchor" aria-label="anchor" href="#data-visualization"></a>
</h2>
<p>The Viola collection data can be visualized using metadata refinement
and plotting functions.</p>
<div class="section level4">
<h4 id="author-distribution">Author Distribution<a class="anchor" aria-label="anchor" href="#author-distribution"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ropengov.github.io/finna/" class="external-link">finna</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Refine metadata and visualize author distribution</span></span>
<span><span class="va">refined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/refine_metadata.html">refine_metadata</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/top_plot.html">top_plot</a></span><span class="op">(</span><span class="va">refined_data</span>, field <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Custom X-axis label</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span>  <span class="co"># Custom Y-axis label</span></span></code></pre></div>
<p><img src="viola_collections_files/figure-html/unnamed-chunk-3-1.png" alt="viola author distribution" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Akewak Jeba, Leo Lahti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
